#Percentil
x = percentile(numbers, 90)
print(x)
x = mode(numbers)
print(x)
#Get mean from vector
x = mean(numbers)
print(x)
#Get media form array
x = median(numbers)
print(x)
#Standard desviation from array
x = sd(numbers)
print(x)
#Percentil
x = percentile(numbers, 90)
print(x)
x = mode(numbers)
print(x)
x = median(numbers)
print(x)
#Function to get Mode
mde <- function(c) {
u <- unique(c)
u[which.max(tabulate(match(v, u)))]
}
print(numbers)
quantile(numbers, probs = c(.25, .5, .75))
# Carregando livrarias
library(FactoMineR)
library(ggplot2)
library(ggdendro)
library(xlsx)
library(cluster)
library(devtools)
library(factoextra)
library(stats)
library(readxl)
library(dendextend)
library(igraph)
#Configurando Ambiente de trabalho
options(digits=15)
options(scipen=15)
options(stringsAsFactors=FALSE)
#Caminho para directorio
dir <-"C:/Mestrado em Estatistica/Trabalho de tese/"
#Estabelecendo o directorio de ambiente de trabalho
setwd(dir)
#Lendo ficheiro excel
df=read_excel("Inflacao.xlsx")
View(df)
#Verificando o dataframe
#numero de colunas
ncol(df)
#numero de linhas
nrow(df)
#Primeiros 2 registos
head(df, 2)
#Transformando tua tabela em um dataframe
df <- as.data.frame(df)
#Primeiros 2 registos (pode-se notar a difenca com o resultado do comando anterior)
head(df, 2)
#Vendo class de cada coluna
str(df)
#Mostrando apenas nomes das colunas
names(df)
nomes_menores = c(
"MBNQTCIX","MBN","MBNQ","MBNQT",
"MBNQTC","MBNQTCI","MBNT","MBNC",
"MBNI","MBNX","MBNQC","MBNQI",
"MBNQX","MBNTC","MBNTI","MBNTX",
"MBNCI","MBNCX","MBNIX","MBNQIX",
"MBNTCI","MBNTIX","MBNTCX",
"MBNQCX","MBNTQI","MBNTQX","MBNCXI",
"MBNIQC","MBNQIXC","MBNQTCX","MBNQTIX",
"MBNTCIX"
)
row.names(df) <- nomes_menores
df <- df[,-1]
df.scale <<- scale(df)
# Para calcular distância ou matriz de dissimilaridade.
dist.euclidean <<- dist(df,method="euclidean")
hc.ward <<- hclust(d=dist.euclidean,method="ward.D2")
hc.average <<- hclust(d=dist.euclidean,method="average")
hc.complete <<- hclust(d=dist.euclidean,method="complete")
df.scale
hc.average
dat <- data.frame(x = rnorm(10, 30, .2), y = runif(10, 3, 5))
scaled.dat <- scale(dat)
# check that we get mean of 0 and sd of 1
colMeans(scaled.dat)  # faster version of apply(scaled.dat, 2, mean)
apply(scaled.dat, 2, sd)
dat
scaled.dat
scaled.dat
#Function to normalize data
#define Min-Max normalization function
min_max_norm <- function(x) {
(x - min(x)) / (max(x) - min(x))
}
v <- c(1,2,4,2,6,8,2,3,4,9,2,1,8,5,6)
norm <- min_max_norm(v)
print(norm)
#R function to normalize data
df <- data.frame(x = rnorm(8, 22, .3))
norm_df <- scale(df)
norm_df
curve(sin, -10 , 10,
main = "Title") # Title
#Chart of sin from -10 to 10
curve(sin, -10 , 10,
main = "Sin chart")
x = c(8,3,2,6)
hist(x, main = "Left plot")
x = c(8,3,2,6,2,6,6,8)
hist(x, main = "Left plot")
x = c(8,3)
hist(x, main = "Left plot")
#Histogram
x = c(8,3,2,6,2,6,6,8)
hist(x, main = "Histogram")
#Boxplot
boxplot(x, main = "BoxPlot")
#Painel with multiple chart
#One row, two columns
par(mfrow = c(1, 2))
hist(x, main = "Histogram")
boxplot(x, main = "BoxPlot")
#Back to default
par(mfrow = c(1, 1))
pie(table(round(x)), main = "Pie")
# plotting vector
barplot(x, xlab = "GeeksforGeeks Audience",
ylab = "Count", col = "white",
col.axis = "darkgreen",
col.lab = "darkgreen")
#Barplot with optionsr
barplot(x, xlab = "Barplot",
ylab = "Count", col = "blue",
col.axis = "green",
col.lab = "black")
#Pie with options
pie(x, labels = names(x),
col = "green",
main = "Pie with options",
radius = -1,
col.main = "blue"
)
#3D Pie
pie3D(x, labels = names(x),
col = "green",
main = "Pie with options",
radius = -1,
col.main = "blue"
)
#Histogram with options
hist(x, main = "Histogram with options",
xlab = "X",
col.lab = "blue",
col.main = "yellow"
)
#Library for 3D Pie Chart
library(plotrix)
#3D Pie
pie3D(x, labels = names(x),
col = "green",
main = "Pie with options",
radius = -1,
col.main = "blue"
)
#Histogram with normal distribution curve
win.graph()
hist(x,freq = F)
curve(dnorm(x,mean(x),sd(x)),add=T)
#Plot with options
plot(x = x,
y = y,
xlab = "x vlaues",
ylab = "Line",
main = "Plotting data",
col.lab = "blue",
col.main = "red",
col.axis = "yellow"
)
x = c(1,2,3,4,5,6,7,8)
y = c(8,3,2,6,2,6,6,8)
#Plot with options
plot(x = x,
y = y,
xlab = "x vlaues",
ylab = "Line",
main = "Plotting data",
col.lab = "blue",
col.main = "red",
col.axis = "yellow"
)
x = c(1,2,3,4,5,6,7,8)
y = c(8,3,2,6,2,6,6,8)
#Plot with options
plot(x = x,
y = y,
xlab = "x vlaues",
ylab = "Line",
main = "Plotting data",
col.lab = "blue",
col.main = "red",
col.axis = "yellow"
)
x = c(1,2,3,4,5,6,7,8)
y = c(8,3,2,6,2,6,6,8)
#Plot with options
plot(x = x,
y = y,
xlab = "x vlaues",
ylab = "Line",
main = "Plotting data",
col.lab = "blue",
col.main = "red",
col.axis = "yellow")
hist(x, main = "Histogram with options",
xlab = "X",
col.lab = "blue",
col.main = "yellow"
)
x = c(1,2,3,4,5,6,7,8)
y = c(8,3,2,6,2,6,6,8)
#Plot with options
plot(x = x,
y = y,
xlab = "x vlaues",
ylab = "Line",
main = "Plotting data",
col.lab = "blue",
col.main = "red",
col.axis = "yellow"
)
#=============================================5W Dataset of PoweBI to OCHA Dataset============================================
#=============================================Version 18Aug2022============================================
#Loading libraries
library(openxlsx)
library(writexl)
library(readxl)
library(plyr)
library(dplyr)
library(gdata)
library(tidyr)
#Month to be processed
mth <- "202209"
#Excel file with dataset that was used to import to PowerBI 5W Dashboard
powebi_ds <- "September 2022 5W Dashboard for Powerbi 14Oct2022.xlsx"
#Outuput indicatores and its correspondent mesures (most of the time this file does not need to be updated)
output_indicator_and_mesures <- "Output_indicator_and_mesure_type.xlsx"
w <- c("Event","Date.of.Entry","Lead.Organization","Organization.type.Lead.Org.","Implementing.Partner","Organization.type.Imp.partner","Donor.Funding.organization","Sector","Subcluster...Sector","Activity.domain","Activity.type","Other.activity.type..if.not.listed.before.","Activity.indicator","Description","Number.of.CFS..CCPC..FFS..materials..meetings..trainings..facilities.delivered","Delivery.modality","Province","District","Population.type","Total.person.targeted","Total.persons.assisted","Total.children.assisted","Total.adults.assisted","Total.person.with.disability.assisted","Total.children.with.disability.assisted","Total.adults.with.disability.assisted","X..of.boys.0.4.assisted","X..of.girls.0.4.assisted","X..of.boys.5.12.assisted","X..of.girls.5.12.assisted","X..of.boys.13.17.assisted","X..of.girls.13.17.assisted","X..of.adult.men.assisted","X..of.adult.women.assisted","X..of.elderly.men.assisted","X..of.elderly.women.assisted","X..of.disabled.boys...18.yrs..assisted","X..of.disabled.girls...18.yrs..assisted","X..of.disabled.adult.men.assisted","X..of.disabled.adults.women.assisted","X..beneficiaries.assisted.non.disaggregated","X..of.children.assisted.non.disaggregated","X..of.adults.assisted.non.disaggregated","Start.month","End.month","Status","Comments","indicator_target","total_reached","total_aggregated","total_pwd","total_flag","ouput_indicator","Posto2","Admin1CODE","district2","Admin2CODE","Posto","Admin3CODE","indicator.for.persons.reached","Location")
o <- c("Lead.organization....organização.líder.","Implementing.Partner..parceiro.de.implementação.","Donor..organização.doadora.","Period..período.","Non...HRP.Project..Ñao..HRP.Projeto.","Cluster..Sector..Cluster..Setor.","Indicator..indicador.","Activity.status..Estado.da.Actividade.","Modality.of.delivery..modalidade.de.serviço.","Activity..Actividade.2","Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador.","Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.","Province..Admin.1....provincia.","District..Admin.2....distrito..cidade.","Sub.districts..Posts..Admin.3...Postos.","Locality.Admin.4..localidade.","Village..Admin.5...aldeia...bairro.","Location.of.service.delivery..local.de.entrega.de.serviço.","Type.of.beneficiary.people.reached..tipo.de.beneficiário..pessoas.alcançadas.","AUTOCOMPLETEDTotal.people.reached..total.de.pessoas.alcançadas.","Boys..18..menino.garoto.","Girls..18..menina.garota.","Men..18...59...homens.","Women..18...59..mulheres.","Elder.men..60....idosos.","Elder.Women..60....idosas.","Number.PWD.Men..número.de.pessoas.com.deficiência..homens.","Number.PWD.Women..número.de.pessoas.com.deficiência..mulheres.","Total.Female","Total.Male","Comments..Comentario.","Type.of.Organization..Lead.organization","Type.of.Organization..Implementing.Partner","P.Code.for.Province..Admin.1.","P.Code.for.District..Admin.2.","P.Code.for.Sub.districts..Posts..Admin.3.","Non.disaggregated")
dir <- "C:/Users/COME/OneDrive - UNHCR/Documents/Data Processing and Visualization/5W Compilation/OCHA/"
df_w <- read.xlsx(paste0(dir, powebi_ds), sheet = 1, detectDates = FALSE, check.names = TRUE)
df_m <- read.xlsx(paste0(dir, output_indicator_and_mesures), sheet = 1, detectDates = FALSE, check.names = TRUE)
#df_o <- read.xlsx(paste0(dir, "Protection Cluster_5W OCHA Template _May 2022.xlsx"), sheet = 1, detectDates = FALSE, check.names = TRUE)
df_w <- df_w[!is.na(df_w$Date.of.Entry) & df_w$Date.of.Entry == mth,]
names(df_w)[names(df_w) == "Lead.Organization"] <- "Lead.organization....organização.líder."
names(df_w)[names(df_w) == "Implementing.Partner"] <- "Implementing.Partner..parceiro.de.implementação."
names(df_w)[names(df_w) == "Donor.Funding.organization"] <- "Donor..organização.doadora."
names(df_w)[names(df_w) == "Date.of.Entry"] <- "Period..período."
names(df_w)[names(df_w) == "Event"] <- "Non...HRP.Project..Ñao..HRP.Projeto."
names(df_w)[names(df_w) == "Subcluster...Sector"] <- "Cluster..Sector..Cluster..Setor."
names(df_w)[names(df_w) == "ouput_indicator"] <- "Indicator..indicador."
names(df_w)[names(df_w) == "Status"] <- "Activity.status..Estado.da.Actividade."
names(df_w)[names(df_w) == "Delivery.modality"] <- "Modality.of.delivery..modalidade.de.serviço."
names(df_w)[names(df_w) == "Province"] <- "Province..Admin.1....provincia."
names(df_w)[names(df_w) == "District"] <- "District..Admin.2....distrito..cidade."
names(df_w)[names(df_w) == "Posto"] <- "Sub.districts..Posts..Admin.3...Postos."
names(df_w)[names(df_w) == "Organization.type.Lead.Org."] <- "Type.of.Organization..Lead.organization"
names(df_w)[names(df_w) == "Organization.type.Imp.partner"] <- "Type.of.Organization..Implementing.Partner"
names(df_w)[names(df_w) == "Admin1CODE"] <- "P.Code.for.Province..Admin.1."
names(df_w)[names(df_w) == "Admin2CODE"] <- "P.Code.for.District..Admin.2."
names(df_w)[names(df_w) == "Admin3CODE"] <- "P.Code.for.Sub.districts..Posts..Admin.3."
names(df_w)[names(df_w) == "Activity.domain"] <- "Activity..Actividade.2"  #doubts to present to Neren as we aggregate data
df_w$Locality.Admin.4..localidade. <- as.character(NA) # With no values
df_w$Village..Admin.5...aldeia...bairro. <- as.character(NA) # With no values
df_w$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. <- as.character(NA)        # With no values
df_w$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. <- as.numeric(df_w$Total.persons.assisted)
df_w$Location.of.service.delivery..local.de.entrega.de.serviço. <- as.character(NA)               # With no values
df_w$Type.of.beneficiary.people.reached..tipo.de.beneficiário..pessoas.alcançadas. <- df_w$Population.type
df_w$AUTOCOMPLETEDTotal.people.reached..total.de.pessoas.alcançadas. <- as.numeric(0) #Auto filled in OCHA Dataset
df_w$Boys..18..menino.garoto. <-  rowSums(df_w[,c("X..of.boys.0.4.assisted", "X..of.boys.5.12.assisted", "X..of.boys.13.17.assisted")], na.rm = TRUE)
df_w$Girls..18..menina.garota. <-  rowSums(df_w[,c("X..of.girls.0.4.assisted", "X..of.girls.5.12.assisted", "X..of.girls.13.17.assisted")], na.rm = TRUE)
df_w$Men..18...59...homens. <- as.numeric(df_w$X..of.adult.men.assisted)
df_w$Women..18...59..mulheres. <- as.numeric(df_w$X..of.adult.women.assisted)
df_w$Elder.men..60....idosos. <- as.numeric(df_w$X..of.elderly.men.assisted)
df_w$Elder.Women..60....idosas. <- as.numeric(df_w$X..of.elderly.women.assisted)
df_w$X..of.disabled.boys...18.yrs..assisted <- as.numeric(df_w$X..of.disabled.boys...18.yrs..assisted)
df_w$X..of.disabled.adult.men.assisted <- as.numeric(df_w$X..of.disabled.adult.men.assisted)
df_w$X..of.disabled.girls...18.yrs..assisted <- as.numeric(df_w$X..of.disabled.girls...18.yrs..assisted)
df_w$X..of.disabled.adults.women.assisted <- as.numeric(df_w$X..of.disabled.adults.women.assisted)
df_w$Girls..18..menina.garota. <- as.numeric(df_w$Girls..18..menina.garota.)
df_w$Women..18...59..mulheres. <- as.numeric(df_w$Women..18...59..mulheres.)
df_w$Elder.Women..60....idosas. <- as.numeric(df_w$Elder.Women..60....idosas.)
df_w$Boys..18..menino.garoto. <- as.numeric(df_w$Boys..18..menino.garoto.)
df_w$Men..18...59...homens. <- as.numeric(df_w$Men..18...59...homens.)
df_w$Elder.men..60....idosos. <- as.numeric(df_w$Elder.men..60....idosos.)
df_w$X..of.children.assisted.non.disaggregated <- as.numeric(df_w$X..of.children.assisted.non.disaggregated)
df_w$X..of.adults.assisted.non.disaggregated <- as.numeric(df_w$X..of.adults.assisted.non.disaggregated)
df_w$Number.PWD.Men..número.de.pessoas.com.deficiência..homens. <-  rowSums(df_w[,c("X..of.disabled.boys...18.yrs..assisted", "X..of.disabled.adult.men.assisted")], na.rm = TRUE)
df_w$Number.PWD.Women..número.de.pessoas.com.deficiência..mulheres. <-  rowSums(df_w[,c("X..of.disabled.girls...18.yrs..assisted", "X..of.disabled.adults.women.assisted")], na.rm = TRUE)
df_w$Total.Female <- rowSums(df_w[,c("Girls..18..menina.garota.", "Women..18...59..mulheres.", "Elder.Women..60....idosas.")], na.rm = TRUE)
df_w$Total.Male <- rowSums(df_w[,c("Boys..18..menino.garoto.", "Men..18...59...homens.", "Elder.men..60....idosos.")], na.rm = TRUE)
df_w$Comments..Comentario. <- as.character(NA) # with no values
df_w$Non.disaggregated <- rowSums(df_w[,c("X..of.children.assisted.non.disaggregated", "X..of.adults.assisted.non.disaggregated")], na.rm = TRUE)
#for(i in o){
#  a <- FALSE;
#  for(y in names(df_w)){
#      if(i == y){
#        a <- TRUE;
#      }
#  }
#  if(!a){
#    print(i);
#  }
#}
#names(df_w)
#str(df_o[,c(21:30,37,38)])
df_o <- df_w[,o]
df_o$agg_var <- paste0(df_o$Cluster..Sector..Cluster..Setor., df_o$Province..Admin.1....provincia.,df_o$District..Admin.2....distrito..cidade., df_o$Sub.districts..Posts..Admin.3...Postos.,df_o$Indicator..indicador.)
df_ag <- aggregate(df_o[,c(21:30,37,37)],by=list(df_o$agg_var),FUN=sum, na.rm=TRUE)
names(df_ag)[names(df_ag) == "Group.1"] <- "agg_var"
df_o <- df_o[,-which(names(df_o) %in% c("Boys..18..menino.garoto.","Girls..18..menina.garota.","Men..18...59...homens.","Women..18...59..mulheres.","Elder.men..60....idosos.","Elder.Women..60....idosas.","Number.PWD.Men..número.de.pessoas.com.deficiência..homens.","Number.PWD.Women..número.de.pessoas.com.deficiência..mulheres.","Total.Female","Total.Male","Non.disaggregated"))]
df_o <- merge(x = df_ag, y = df_o, by = c("agg_var"), all.x = TRUE)
df_o <- merge(x = df_o, y = df_m, by = c("Indicator..indicador."), all.x = TRUE)
df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. <- df_o$mesure_unit
df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. <- ifelse(is.na(df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.) | df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. == "", "0", df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.)
df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. <- ifelse(!is.na(df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador.) & (df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. == "Sites" | df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. == "Activities" | df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. == "Structures") & !is.na(df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.) & df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. == "0", "No data", df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.)
df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. <- ifelse(!is.na(df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador.) & (df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. == "Sites" | df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. == "Activities" | df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. == "Structures") & !is.na(df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.) & df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. != "0" & df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. != "No data", "1", df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.)
df_o <- df_o[!duplicated(df_o$agg_var),]
df_o <- df_o[,o]
#names(df_o)
#names(df_ag)
#names(df_o[,c(20:30,37,38)])
#Getting date and time
dt <- gsub(" ", "_", gsub(":", "", gsub("-", "", Sys.time())))
#Create folder for output if not exist
dir.create(file.path(dir, "output"), showWarnings = FALSE)
write_xlsx(df_o, paste0(dir, "output/_5W OCHA Template 10Nov2022_", dt, ".xlsx"))
names(df_m)
#Month to be processed
mth <- "202209"
#Excel file with dataset that was used to import to PowerBI 5W Dashboard
powebi_ds <- "September 2022 5W Dashboard for Powerbi 14Oct2022.xlsx"
#Outuput indicatores and its correspondent mesures (most of the time this file does not need to be updated)
output_indicator_and_mesures <- "Output_indicator_and_mesure_type.xlsx"
w <- c("Event","Date.of.Entry","Lead.Organization","Organization.type.Lead.Org.","Implementing.Partner","Organization.type.Imp.partner","Donor.Funding.organization","Sector","Subcluster...Sector","Activity.domain","Activity.type","Other.activity.type..if.not.listed.before.","Activity.indicator","Description","Number.of.CFS..CCPC..FFS..materials..meetings..trainings..facilities.delivered","Delivery.modality","Province","District","Population.type","Total.person.targeted","Total.persons.assisted","Total.children.assisted","Total.adults.assisted","Total.person.with.disability.assisted","Total.children.with.disability.assisted","Total.adults.with.disability.assisted","X..of.boys.0.4.assisted","X..of.girls.0.4.assisted","X..of.boys.5.12.assisted","X..of.girls.5.12.assisted","X..of.boys.13.17.assisted","X..of.girls.13.17.assisted","X..of.adult.men.assisted","X..of.adult.women.assisted","X..of.elderly.men.assisted","X..of.elderly.women.assisted","X..of.disabled.boys...18.yrs..assisted","X..of.disabled.girls...18.yrs..assisted","X..of.disabled.adult.men.assisted","X..of.disabled.adults.women.assisted","X..beneficiaries.assisted.non.disaggregated","X..of.children.assisted.non.disaggregated","X..of.adults.assisted.non.disaggregated","Start.month","End.month","Status","Comments","indicator_target","total_reached","total_aggregated","total_pwd","total_flag","ouput_indicator","Posto2","Admin1CODE","district2","Admin2CODE","Posto","Admin3CODE","indicator.for.persons.reached","Location")
o <- c("Lead.organization....organização.líder.","Implementing.Partner..parceiro.de.implementação.","Donor..organização.doadora.","Period..período.","Non...HRP.Project..Ñao..HRP.Projeto.","Cluster..Sector..Cluster..Setor.","Indicator..indicador.","Activity.status..Estado.da.Actividade.","Modality.of.delivery..modalidade.de.serviço.","Activity..Actividade.2","Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador.","Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.","Province..Admin.1....provincia.","District..Admin.2....distrito..cidade.","Sub.districts..Posts..Admin.3...Postos.","Locality.Admin.4..localidade.","Village..Admin.5...aldeia...bairro.","Location.of.service.delivery..local.de.entrega.de.serviço.","Type.of.beneficiary.people.reached..tipo.de.beneficiário..pessoas.alcançadas.","AUTOCOMPLETEDTotal.people.reached..total.de.pessoas.alcançadas.","Boys..18..menino.garoto.","Girls..18..menina.garota.","Men..18...59...homens.","Women..18...59..mulheres.","Elder.men..60....idosos.","Elder.Women..60....idosas.","Number.PWD.Men..número.de.pessoas.com.deficiência..homens.","Number.PWD.Women..número.de.pessoas.com.deficiência..mulheres.","Total.Female","Total.Male","Comments..Comentario.","Type.of.Organization..Lead.organization","Type.of.Organization..Implementing.Partner","P.Code.for.Province..Admin.1.","P.Code.for.District..Admin.2.","P.Code.for.Sub.districts..Posts..Admin.3.","Non.disaggregated")
dir <- "C:/Users/COME/OneDrive - UNHCR/Documents/Data Processing and Visualization/5W Compilation/OCHA/"
df_w <- read.xlsx(paste0(dir, powebi_ds), sheet = 1, detectDates = FALSE, check.names = TRUE)
df_m <- read.xlsx(paste0(dir, output_indicator_and_mesures), sheet = 1, detectDates = FALSE, check.names = TRUE)
df_w <- read.xlsx(paste0(dir, powebi_ds), sheet = 1, check.names = TRUE)
#Month to be processed
mth <- "202209"
gclns <- c(1,1,2,3,5,7,9,10,13,14,16,15,17,17,18,54,62,63,64,19,21:40,42,43,46,47,47,55,57,59)
#Directory path
dir <- "C:/Users/COME/OneDrive - UNHCR/Documents/Data Processing and Visualization/5W Compilation/"
#Excel file with dataset that was used to import to PowerBI 5W Dashboard
powebi_ds <- "September 2022 5W Dashboard for Powerbi 14Oct2022_final.xlsx"
df_o <- read.xlsx(paste0(dir, powebi_ds), sheet = 1, detectDates = FALSE, check.names = TRUE)
#Month to be processed
mth <- "202209"
gclns <- c(1,1,2,3,5,7,9,10,13,14,16,15,17,17,18,54,62,63,64,19,21:40,42,43,46,47,47,55,57,59)
#Directory path
dir <- "C:/Users/COME/OneDrive - UNHCR/Documents/Data Processing and Visualization/5W Compilation/"
#Excel file with dataset that was used to import to PowerBI 5W Dashboard
powebi_ds <- "September 2022 5W Dashboard for Powerbi 14Oct2022_final.xlsx"
df_o <- read_xlsx(paste0(dir, powebi_ds), sheet = 1)
warnings()
head(df_o, 6)
names(df_o)
#Month to be processed
mth <- "202209"
#Excel file with dataset that was used to import to PowerBI 5W Dashboard
powebi_ds <- "September 2022 5W Dashboard for Powerbi 14Oct2022.xlsx"
#Outuput indicatores and its correspondent mesures (most of the time this file does not need to be updated)
output_indicator_and_mesures <- "Output_indicator_and_mesure_type.xlsx"
w <- c("Event","Date.of.Entry","Lead.Organization","Organization.type.Lead.Org.","Implementing.Partner","Organization.type.Imp.partner","Donor.Funding.organization","Sector","Subcluster...Sector","Activity.domain","Activity.type","Other.activity.type..if.not.listed.before.","Activity.indicator","Description","Number.of.CFS..CCPC..FFS..materials..meetings..trainings..facilities.delivered","Delivery.modality","Province","District","Population.type","Total.person.targeted","Total.persons.assisted","Total.children.assisted","Total.adults.assisted","Total.person.with.disability.assisted","Total.children.with.disability.assisted","Total.adults.with.disability.assisted","X..of.boys.0.4.assisted","X..of.girls.0.4.assisted","X..of.boys.5.12.assisted","X..of.girls.5.12.assisted","X..of.boys.13.17.assisted","X..of.girls.13.17.assisted","X..of.adult.men.assisted","X..of.adult.women.assisted","X..of.elderly.men.assisted","X..of.elderly.women.assisted","X..of.disabled.boys...18.yrs..assisted","X..of.disabled.girls...18.yrs..assisted","X..of.disabled.adult.men.assisted","X..of.disabled.adults.women.assisted","X..beneficiaries.assisted.non.disaggregated","X..of.children.assisted.non.disaggregated","X..of.adults.assisted.non.disaggregated","Start.month","End.month","Status","Comments","indicator_target","total_reached","total_aggregated","total_pwd","total_flag","ouput_indicator","Posto2","Admin1CODE","district2","Admin2CODE","Posto","Admin3CODE","indicator.for.persons.reached","Location")
o <- c("Lead.organization....organização.líder.","Implementing.Partner..parceiro.de.implementação.","Donor..organização.doadora.","Period..período.","Non...HRP.Project..Ñao..HRP.Projeto.","Cluster..Sector..Cluster..Setor.","Indicator..indicador.","Activity.status..Estado.da.Actividade.","Modality.of.delivery..modalidade.de.serviço.","Activity..Actividade.2","Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador.","Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.","Province..Admin.1....provincia.","District..Admin.2....distrito..cidade.","Sub.districts..Posts..Admin.3...Postos.","Locality.Admin.4..localidade.","Village..Admin.5...aldeia...bairro.","Location.of.service.delivery..local.de.entrega.de.serviço.","Type.of.beneficiary.people.reached..tipo.de.beneficiário..pessoas.alcançadas.","AUTOCOMPLETEDTotal.people.reached..total.de.pessoas.alcançadas.","Boys..18..menino.garoto.","Girls..18..menina.garota.","Men..18...59...homens.","Women..18...59..mulheres.","Elder.men..60....idosos.","Elder.Women..60....idosas.","Number.PWD.Men..número.de.pessoas.com.deficiência..homens.","Number.PWD.Women..número.de.pessoas.com.deficiência..mulheres.","Total.Female","Total.Male","Comments..Comentario.","Type.of.Organization..Lead.organization","Type.of.Organization..Implementing.Partner","P.Code.for.Province..Admin.1.","P.Code.for.District..Admin.2.","P.Code.for.Sub.districts..Posts..Admin.3.","Non.disaggregated")
dir <- "C:/Users/COME/OneDrive - UNHCR/Documents/Data Processing and Visualization/5W Compilation/OCHA/"
df_w <- read_xlsx(paste0(dir, powebi_ds), sheet = 1)
df_m <- read_xlsx(paste0(dir, output_indicator_and_mesures), sheet = 1)
#df_o <- read.xlsx(paste0(dir, "Protection Cluster_5W OCHA Template _May 2022.xlsx"), sheet = 1, detectDates = FALSE, check.names = TRUE)
df_w <- df_w[!is.na(df_w$Date.of.Entry) & df_w$Date.of.Entry == mth,]
names(df_w)[names(df_w) == "Lead.Organization"] <- "Lead.organization....organização.líder."
names(df_w)[names(df_w) == "Implementing.Partner"] <- "Implementing.Partner..parceiro.de.implementação."
names(df_w)[names(df_w) == "Donor.Funding.organization"] <- "Donor..organização.doadora."
names(df_w)[names(df_w) == "Date.of.Entry"] <- "Period..período."
names(df_w)[names(df_w) == "Event"] <- "Non...HRP.Project..Ñao..HRP.Projeto."
names(df_w)[names(df_w) == "Subcluster...Sector"] <- "Cluster..Sector..Cluster..Setor."
names(df_w)[names(df_w) == "ouput_indicator"] <- "Indicator..indicador."
names(df_w)[names(df_w) == "Status"] <- "Activity.status..Estado.da.Actividade."
names(df_w)[names(df_w) == "Delivery.modality"] <- "Modality.of.delivery..modalidade.de.serviço."
names(df_w)[names(df_w) == "Province"] <- "Province..Admin.1....provincia."
names(df_w)[names(df_w) == "District"] <- "District..Admin.2....distrito..cidade."
names(df_w)[names(df_w) == "Posto"] <- "Sub.districts..Posts..Admin.3...Postos."
names(df_w)[names(df_w) == "Organization.type.Lead.Org."] <- "Type.of.Organization..Lead.organization"
names(df_w)[names(df_w) == "Organization.type.Imp.partner"] <- "Type.of.Organization..Implementing.Partner"
names(df_w)[names(df_w) == "Admin1CODE"] <- "P.Code.for.Province..Admin.1."
names(df_w)[names(df_w) == "Admin2CODE"] <- "P.Code.for.District..Admin.2."
names(df_w)[names(df_w) == "Admin3CODE"] <- "P.Code.for.Sub.districts..Posts..Admin.3."
names(df_w)[names(df_w) == "Activity.domain"] <- "Activity..Actividade.2"  #doubts to present to Neren as we aggregate data
df_w$Locality.Admin.4..localidade. <- as.character(NA) # With no values
df_w$Village..Admin.5...aldeia...bairro. <- as.character(NA) # With no values
df_w$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. <- as.character(NA)        # With no values
df_w$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. <- as.numeric(df_w$Total.persons.assisted)
df_w$Location.of.service.delivery..local.de.entrega.de.serviço. <- as.character(NA)               # With no values
df_w$Type.of.beneficiary.people.reached..tipo.de.beneficiário..pessoas.alcançadas. <- df_w$Population.type
df_w$AUTOCOMPLETEDTotal.people.reached..total.de.pessoas.alcançadas. <- as.numeric(0) #Auto filled in OCHA Dataset
df_w$Boys..18..menino.garoto. <-  rowSums(df_w[,c("X..of.boys.0.4.assisted", "X..of.boys.5.12.assisted", "X..of.boys.13.17.assisted")], na.rm = TRUE)
df_w$Girls..18..menina.garota. <-  rowSums(df_w[,c("X..of.girls.0.4.assisted", "X..of.girls.5.12.assisted", "X..of.girls.13.17.assisted")], na.rm = TRUE)
df_w$Men..18...59...homens. <- as.numeric(df_w$X..of.adult.men.assisted)
df_w$Women..18...59..mulheres. <- as.numeric(df_w$X..of.adult.women.assisted)
df_w$Elder.men..60....idosos. <- as.numeric(df_w$X..of.elderly.men.assisted)
df_w$Elder.Women..60....idosas. <- as.numeric(df_w$X..of.elderly.women.assisted)
df_w$X..of.disabled.boys...18.yrs..assisted <- as.numeric(df_w$X..of.disabled.boys...18.yrs..assisted)
df_w$X..of.disabled.adult.men.assisted <- as.numeric(df_w$X..of.disabled.adult.men.assisted)
df_w$X..of.disabled.girls...18.yrs..assisted <- as.numeric(df_w$X..of.disabled.girls...18.yrs..assisted)
df_w$X..of.disabled.adults.women.assisted <- as.numeric(df_w$X..of.disabled.adults.women.assisted)
df_w$Girls..18..menina.garota. <- as.numeric(df_w$Girls..18..menina.garota.)
df_w$Women..18...59..mulheres. <- as.numeric(df_w$Women..18...59..mulheres.)
df_w$Elder.Women..60....idosas. <- as.numeric(df_w$Elder.Women..60....idosas.)
df_w$Boys..18..menino.garoto. <- as.numeric(df_w$Boys..18..menino.garoto.)
df_w$Men..18...59...homens. <- as.numeric(df_w$Men..18...59...homens.)
df_w$Elder.men..60....idosos. <- as.numeric(df_w$Elder.men..60....idosos.)
df_w$X..of.children.assisted.non.disaggregated <- as.numeric(df_w$X..of.children.assisted.non.disaggregated)
df_w$X..of.adults.assisted.non.disaggregated <- as.numeric(df_w$X..of.adults.assisted.non.disaggregated)
df_w$Number.PWD.Men..número.de.pessoas.com.deficiência..homens. <-  rowSums(df_w[,c("X..of.disabled.boys...18.yrs..assisted", "X..of.disabled.adult.men.assisted")], na.rm = TRUE)
df_w$Number.PWD.Women..número.de.pessoas.com.deficiência..mulheres. <-  rowSums(df_w[,c("X..of.disabled.girls...18.yrs..assisted", "X..of.disabled.adults.women.assisted")], na.rm = TRUE)
df_w$Total.Female <- rowSums(df_w[,c("Girls..18..menina.garota.", "Women..18...59..mulheres.", "Elder.Women..60....idosas.")], na.rm = TRUE)
df_w$Total.Male <- rowSums(df_w[,c("Boys..18..menino.garoto.", "Men..18...59...homens.", "Elder.men..60....idosos.")], na.rm = TRUE)
df_w$Comments..Comentario. <- as.character(NA) # with no values
df_w$Non.disaggregated <- rowSums(df_w[,c("X..of.children.assisted.non.disaggregated", "X..of.adults.assisted.non.disaggregated")], na.rm = TRUE)
#for(i in o){
#  a <- FALSE;
#  for(y in names(df_w)){
#      if(i == y){
#        a <- TRUE;
#      }
#  }
#  if(!a){
#    print(i);
#  }
#}
#names(df_w)
#str(df_o[,c(21:30,37,38)])
df_o <- df_w[,o]
df_o$agg_var <- paste0(df_o$Cluster..Sector..Cluster..Setor., df_o$Province..Admin.1....provincia.,df_o$District..Admin.2....distrito..cidade., df_o$Sub.districts..Posts..Admin.3...Postos.,df_o$Indicator..indicador.)
df_ag <- aggregate(df_o[,c(21:30,37,37)],by=list(df_o$agg_var),FUN=sum, na.rm=TRUE)
names(df_ag)[names(df_ag) == "Group.1"] <- "agg_var"
df_o <- df_o[,-which(names(df_o) %in% c("Boys..18..menino.garoto.","Girls..18..menina.garota.","Men..18...59...homens.","Women..18...59..mulheres.","Elder.men..60....idosos.","Elder.Women..60....idosas.","Number.PWD.Men..número.de.pessoas.com.deficiência..homens.","Number.PWD.Women..número.de.pessoas.com.deficiência..mulheres.","Total.Female","Total.Male","Non.disaggregated"))]
df_o <- merge(x = df_ag, y = df_o, by = c("agg_var"), all.x = TRUE)
df_o <- merge(x = df_o, y = df_m, by = c("Indicator..indicador."), all.x = TRUE)
df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. <- df_o$mesure_unit
df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. <- ifelse(is.na(df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.) | df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. == "", "0", df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.)
df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. <- ifelse(!is.na(df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador.) & (df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. == "Sites" | df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. == "Activities" | df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. == "Structures") & !is.na(df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.) & df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. == "0", "No data", df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.)
df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. <- ifelse(!is.na(df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador.) & (df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. == "Sites" | df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. == "Activities" | df_o$Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador. == "Structures") & !is.na(df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.) & df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. != "0" & df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador. != "No data", "1", df_o$Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.)
df_o <- df_o[!duplicated(df_o$agg_var),]
df_o <- df_o[,o]
#names(df_o)
#names(df_ag)
#names(df_o[,c(20:30,37,38)])
#Getting date and time
dt <- gsub(" ", "_", gsub(":", "", gsub("-", "", Sys.time())))
#Create folder for output if not exist
dir.create(file.path(dir, "output"), showWarnings = FALSE)
write_xlsx(df_o, paste0(dir, "output/_5W OCHA Template 10Nov2022_", dt, ".xlsx"))
#=============================================5W Dataset of PoweBI to OCHA Dataset============================================
#=============================================Version 18Aug2022============================================
#Loading libraries
library(openxlsx)
library(writexl)
library(readxl)
library(plyr)
library(dplyr)
library(gdata)
library(tidyr)
#Month to be processed
mth <- "202209"
#Excel file with dataset that was used to import to PowerBI 5W Dashboard
powebi_ds <- "September 2022 5W Dashboard for Powerbi 14Oct2022.xlsx"
#Outuput indicatores and its correspondent mesures (most of the time this file does not need to be updated)
output_indicator_and_mesures <- "Output_indicator_and_mesure_type.xlsx"
w <- c("Event","Date.of.Entry","Lead.Organization","Organization.type.Lead.Org.","Implementing.Partner","Organization.type.Imp.partner","Donor.Funding.organization","Sector","Subcluster...Sector","Activity.domain","Activity.type","Other.activity.type..if.not.listed.before.","Activity.indicator","Description","Number.of.CFS..CCPC..FFS..materials..meetings..trainings..facilities.delivered","Delivery.modality","Province","District","Population.type","Total.person.targeted","Total.persons.assisted","Total.children.assisted","Total.adults.assisted","Total.person.with.disability.assisted","Total.children.with.disability.assisted","Total.adults.with.disability.assisted","X..of.boys.0.4.assisted","X..of.girls.0.4.assisted","X..of.boys.5.12.assisted","X..of.girls.5.12.assisted","X..of.boys.13.17.assisted","X..of.girls.13.17.assisted","X..of.adult.men.assisted","X..of.adult.women.assisted","X..of.elderly.men.assisted","X..of.elderly.women.assisted","X..of.disabled.boys...18.yrs..assisted","X..of.disabled.girls...18.yrs..assisted","X..of.disabled.adult.men.assisted","X..of.disabled.adults.women.assisted","X..beneficiaries.assisted.non.disaggregated","X..of.children.assisted.non.disaggregated","X..of.adults.assisted.non.disaggregated","Start.month","End.month","Status","Comments","indicator_target","total_reached","total_aggregated","total_pwd","total_flag","ouput_indicator","Posto2","Admin1CODE","district2","Admin2CODE","Posto","Admin3CODE","indicator.for.persons.reached","Location")
o <- c("Lead.organization....organização.líder.","Implementing.Partner..parceiro.de.implementação.","Donor..organização.doadora.","Period..período.","Non...HRP.Project..Ñao..HRP.Projeto.","Cluster..Sector..Cluster..Setor.","Indicator..indicador.","Activity.status..Estado.da.Actividade.","Modality.of.delivery..modalidade.de.serviço.","Activity..Actividade.2","Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador.","Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.","Province..Admin.1....provincia.","District..Admin.2....distrito..cidade.","Sub.districts..Posts..Admin.3...Postos.","Locality.Admin.4..localidade.","Village..Admin.5...aldeia...bairro.","Location.of.service.delivery..local.de.entrega.de.serviço.","Type.of.beneficiary.people.reached..tipo.de.beneficiário..pessoas.alcançadas.","AUTOCOMPLETEDTotal.people.reached..total.de.pessoas.alcançadas.","Boys..18..menino.garoto.","Girls..18..menina.garota.","Men..18...59...homens.","Women..18...59..mulheres.","Elder.men..60....idosos.","Elder.Women..60....idosas.","Number.PWD.Men..número.de.pessoas.com.deficiência..homens.","Number.PWD.Women..número.de.pessoas.com.deficiência..mulheres.","Total.Female","Total.Male","Comments..Comentario.","Type.of.Organization..Lead.organization","Type.of.Organization..Implementing.Partner","P.Code.for.Province..Admin.1.","P.Code.for.District..Admin.2.","P.Code.for.Sub.districts..Posts..Admin.3.","Non.disaggregated")
dir <- "C:/Users/COME/OneDrive - UNHCR/Documents/Data Processing and Visualization/5W Compilation/OCHA/"
df_w <- read.xlsx(paste0(dir, powebi_ds), sheet = 1, detectDates = FALSE, check.names = TRUE)
df_m <- read.xlsx(paste0(dir, output_indicator_and_mesures), sheet = 1, detectDates = FALSE, check.names = TRUE)
df_w <- read.xlsx(paste0(dir, powebi_ds), sheet = 1, detectDates = FALSE, check.names = TRUE)
#Loading libraries
library(openxlsx)
library(writexl)
#library(readxl)
library(plyr)
library(dplyr)
library(gdata)
library(tidyr)
#Month to be processed
mth <- "202209"
#Excel file with dataset that was used to import to PowerBI 5W Dashboard
powebi_ds <- "September 2022 5W Dashboard for Powerbi 14Oct2022.xlsx"
#Outuput indicatores and its correspondent mesures (most of the time this file does not need to be updated)
output_indicator_and_mesures <- "Output_indicator_and_mesure_type.xlsx"
w <- c("Event","Date.of.Entry","Lead.Organization","Organization.type.Lead.Org.","Implementing.Partner","Organization.type.Imp.partner","Donor.Funding.organization","Sector","Subcluster...Sector","Activity.domain","Activity.type","Other.activity.type..if.not.listed.before.","Activity.indicator","Description","Number.of.CFS..CCPC..FFS..materials..meetings..trainings..facilities.delivered","Delivery.modality","Province","District","Population.type","Total.person.targeted","Total.persons.assisted","Total.children.assisted","Total.adults.assisted","Total.person.with.disability.assisted","Total.children.with.disability.assisted","Total.adults.with.disability.assisted","X..of.boys.0.4.assisted","X..of.girls.0.4.assisted","X..of.boys.5.12.assisted","X..of.girls.5.12.assisted","X..of.boys.13.17.assisted","X..of.girls.13.17.assisted","X..of.adult.men.assisted","X..of.adult.women.assisted","X..of.elderly.men.assisted","X..of.elderly.women.assisted","X..of.disabled.boys...18.yrs..assisted","X..of.disabled.girls...18.yrs..assisted","X..of.disabled.adult.men.assisted","X..of.disabled.adults.women.assisted","X..beneficiaries.assisted.non.disaggregated","X..of.children.assisted.non.disaggregated","X..of.adults.assisted.non.disaggregated","Start.month","End.month","Status","Comments","indicator_target","total_reached","total_aggregated","total_pwd","total_flag","ouput_indicator","Posto2","Admin1CODE","district2","Admin2CODE","Posto","Admin3CODE","indicator.for.persons.reached","Location")
o <- c("Lead.organization....organização.líder.","Implementing.Partner..parceiro.de.implementação.","Donor..organização.doadora.","Period..período.","Non...HRP.Project..Ñao..HRP.Projeto.","Cluster..Sector..Cluster..Setor.","Indicator..indicador.","Activity.status..Estado.da.Actividade.","Modality.of.delivery..modalidade.de.serviço.","Activity..Actividade.2","Unit.of.measure.of.the.indicator..unidad.de.medida.du.indicador.","Total.achieved.as.per.indicator..total.alcançado.de.acordo.com.indicador.","Province..Admin.1....provincia.","District..Admin.2....distrito..cidade.","Sub.districts..Posts..Admin.3...Postos.","Locality.Admin.4..localidade.","Village..Admin.5...aldeia...bairro.","Location.of.service.delivery..local.de.entrega.de.serviço.","Type.of.beneficiary.people.reached..tipo.de.beneficiário..pessoas.alcançadas.","AUTOCOMPLETEDTotal.people.reached..total.de.pessoas.alcançadas.","Boys..18..menino.garoto.","Girls..18..menina.garota.","Men..18...59...homens.","Women..18...59..mulheres.","Elder.men..60....idosos.","Elder.Women..60....idosas.","Number.PWD.Men..número.de.pessoas.com.deficiência..homens.","Number.PWD.Women..número.de.pessoas.com.deficiência..mulheres.","Total.Female","Total.Male","Comments..Comentario.","Type.of.Organization..Lead.organization","Type.of.Organization..Implementing.Partner","P.Code.for.Province..Admin.1.","P.Code.for.District..Admin.2.","P.Code.for.Sub.districts..Posts..Admin.3.","Non.disaggregated")
dir <- "C:/Users/COME/OneDrive - UNHCR/Documents/Data Processing and Visualization/5W Compilation/OCHA/"
df_w <- read.xlsx(paste0(dir, powebi_ds), sheet = 1, detectDates = FALSE, check.names = TRUE)
df_w <- read.xlsx(paste0(dir, powebi_ds), detectDates = FALSE, check.names = TRUE)
df_w <- read.xlsx(paste0(dir, powebi_ds), sheet = 1, detectDates = FALSE, check.names = TRUE)
